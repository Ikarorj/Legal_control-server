# LegalControl Server â€” Backend do Sistema de GestÃ£o de Processos JurÃ­dicos

Este repositÃ³rio contÃ©m o backend do LegalControl, um sistema web moderno para gerenciamento de processos jurÃ­dicos.

O backend Ã© responsÃ¡vel por:

- Implementar regras de negÃ³cio e autenticaÃ§Ã£o segura
- Gerenciar a persistÃªncia de dados criptografados no banco PostgreSQL
- Expor uma API REST para o frontend consumir
- Garantir a seguranÃ§a e integridade das informaÃ§Ãµes usando Google Cloud KMS para criptografia

O frontend do sistema estÃ¡ disponÃ­vel neste repositÃ³rio: [client-process-portal](https://github.com/igordev23/client-process-portal).

## ğŸ¯ Objetivo do Backend

Fornecer uma base sÃ³lida e segura para que advogados, funcionÃ¡rios e clientes possam gerenciar informaÃ§Ãµes jurÃ­dicas de forma confiÃ¡vel, eliminando o uso de planilhas manuais e riscos associados.

## ğŸ“‹ Contexto do Projeto

Atualmente, a gestÃ£o de processos jurÃ­dicos Ã© feita manualmente em planilhas, com riscos de erros, falta de seguranÃ§a e dificuldades de acesso remoto. O backend do LegalControl oferece:

- API centralizada para controle de clientes, processos e usuÃ¡rios
- Criptografia avanÃ§ada para proteger dados sensÃ­veis
- Estrutura modular em Node.js + TypeScript para escalabilidade
- IntegraÃ§Ã£o com frontend moderno hospedado no Render

## ğŸš€ Tecnologias e Ferramentas

- **Node.js 18+** com **TypeScript**
- **Express 5**
- **PostgreSQL** (via `pg`)
- **Google Cloud KMS** para criptografia (`@google-cloud/kms` + `crypto-js`)
- **Bcrypt** para hash de senhas (`bcrypt` e `bcryptjs`)
- **Dotenv** para variÃ¡veis de ambiente
- **CORS** para controle de acesso

## ğŸ“ OrganizaÃ§Ã£o do Projeto

```
legal_control-server-main/
â”œâ”€â”€ dist/               # CÃ³digo compilado JavaScript (build)
â”œâ”€â”€ node_modules/       # DependÃªncias instaladas
â”œâ”€â”€ src/                # CÃ³digo-fonte TypeScript
â”‚   â”œâ”€â”€ controllers/    # LÃ³gica dos endpoints (ex: clients.controller.ts)
â”‚   â”œâ”€â”€ routes/         # DefiniÃ§Ã£o das rotas (ex: clients.routes.ts)
â”‚   â”œâ”€â”€ services/       # ServiÃ§os auxiliares (ex: kmsService.ts, db.ts)
â”‚   â”œâ”€â”€ db.ts           # ConfiguraÃ§Ã£o da conexÃ£o com o banco
â”‚   â”œâ”€â”€ kms.ts          # ConfiguraÃ§Ã£o Google Cloud KMS
â”‚   â”œâ”€â”€ seedUsers.ts    # Script para popular usuÃ¡rios iniciais
â”‚   â””â”€â”€ server.ts       # Ponto de entrada do servidor
â”œâ”€â”€ .env                # VariÃ¡veis de ambiente (nÃ£o versionado)
â”œâ”€â”€ .gitignore          # Arquivos ignorados pelo Git
â”œâ”€â”€ kms.json            # Credenciais Google Cloud KMS (nÃ£o versionado)
â”œâ”€â”€ package.json        # ConfiguraÃ§Ã£o do npm
â”œâ”€â”€ package-lock.json   # Lockfile do npm
â”œâ”€â”€ README.md           # DocumentaÃ§Ã£o do projeto
â”œâ”€â”€ tsconfig.json       # ConfiguraÃ§Ã£o do TypeScript

```

## ğŸ› ï¸ Rodando localmente

### Passos

```bash
# Clonar repo
git clone https://github.com/seu-usuario/legal_control-server.git
cd legal_control_server

# Instalar dependÃªncias
npm install

# Criar arquivo .env (exemplo abaixo)
cp .env.example .env

# Rodar em desenvolvimento (ts-node)
npm run dev

# Compilar para JavaScript (dist/)
npm run build

# Rodar em produÃ§Ã£o
npm start
```

### VariÃ¡veis de Ambiente (`.env`)

```env
PORT=5000
NODE_ENV=development

# PostgreSQL
PG_HOST=localhost
PG_PORT=5432
PG_DATABASE=legalcontrol
PG_USER=postgres
PG_PASSWORD=senha_segura

# Google Cloud KMS
GOOGLE_APPLICATION_CREDENTIALS=./kms.json
KMS_KEY_NAME=projects/seu-projeto/locations/global/keyRings/seu-keyring/cryptoKeys/sua-chave
```

## âš™ï¸ Funcionalidades Principais

- CRUD completo para clientes, com criptografia de campos sensÃ­veis
- Hash seguro de senhas para usuÃ¡rios (via bcrypt)
- Endpoints para gerenciamento de processos, usuÃ¡rios e configuraÃ§Ãµes
- Tratamento de erros e respostas JSON padronizadas

## ğŸ”— IntegraÃ§Ã£o com Frontend

O backend serve dados e regras para o frontend hospedado no Render. As URLs da API devem ser configuradas no frontend conforme a URL do backend em produÃ§Ã£o.

## ğŸ¤ Contribuindo

1. FaÃ§a um fork deste repositÃ³rio
2. Crie uma branch para sua feature (`git checkout -b feature/nome-da-feature`)
3. Commit suas alteraÃ§Ãµes (`git commit -m "feat: descriÃ§Ã£o da feature"`)
4. Push para sua branch (`git push origin feature/nome-da-feature`)
5. Abra um Pull Request

## ğŸ“„ LicenÃ§a

Projeto licenciado sob ISC License.
